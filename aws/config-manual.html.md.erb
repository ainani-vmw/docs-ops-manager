---
title: Configuring BOSH Director on AWS
owner: Ops Manager
iaas: AWS
install_type: manual
---

You can configure BOSH Director to deploy <%= vars.ops_manager_first %> on Amazon Web Services (AWS).

Before you begin this procedure, ensure that you have followed all of the steps in [Deploying <%= vars.ops_manager %> on AWS](deploy-manual.html).

## <a id='pcfaws-om-access'></a> Step 1: Log in to <%= vars.ops_manager %>

1. In a web browser, go to the fully qualified domain that you created in the [Configure DNS Records](deploy-manual.html#pcfaws-dns) step of _Deploying <%= vars.ops_manager %> on AWS_.

1. Log in to <%= vars.ops_manager %>. To log in, see [Log In to <%= vars.ops_manager %> For the First Time](../login.html#login-first-time).

## <a id='pcfaws-om-awsconfig'></a> Step 2: AWS Config page

1. Click the **BOSH Director** tile.

1. Click **AWS Config**. The **AWS Management Console Config** page appears.

    ![alt-text=""](../common/images/cloudform/aws-config.png)

2. Click **Use AWS Keys** or **Use AWS Instance Profile**.
    * **Access Key ID** and **AWS Secret Key**: To retrieve your AWS key information, use the AWS Identity and Access Management (IAM) credentials that you generated in [Step 3: Create an IAM User for <%= vars.ops_manager %>](prepare-env-manual.html#create-iam) in _Preparing to Deploy <%= vars.ops_manager %> on AWS_.
    * **AWS IAM Instance Profile**: Enter the name of the IAM profile you created in [Step 3: Create an IAM User for <%= vars.ops_manager %>](prepare-env-manual.html#create-iam) in _Preparing to Deploy <%= vars.ops_manager %> on AWS_.

1. Complete the rest of the **AWS Management Console Config** page:
    * **Security Group ID**: Enter the **Group ID** of the `pcf-vms-security-group` you created for your <%= vars.ops_manager %> VMs in the [Configure a Security Group for <%= vars.ops_manager %> VMs](prepare-env-manual.html#pcfaws-om-ersecgrp) in _Preparing to Deploy <%= vars.ops_manager %> on AWS_. Locate the Group ID in the **Security Groups** tab of your EC2 Dashboard.
    * **Key Pair Name**: Enter `pcf-ops-manager-key`.
    * **SSH Private Key**: Open the AWS key pair `pcf-ops-manager-keys.pem` file you generated in [Step 3: Create an IAM User for <%= vars.ops_manager %>](prepare-env-manual.html#create-iam) in _Preparing to Deploy <%= vars.ops_manager %> on AWS_. Copy the contents of the `.pem` file and paste it into the **SSH Private Key** text box.
    * **Region**: Click the region where you deployed <%= vars.ops_manager %>.
    * **VM Type Catalog** Click the VM catalog that you want to use for your BOSH-deployed VMs.
    * **AWS EBS disk type**: Click the type of EBS volume for BOSH deployed VMs to use.

    <p class="note caution">
      <span class="note__title">Caution</span>
      If you change this value, BOSH recreates all VMs when you apply changes.</p>

    * **Encrypt Linux EBS Volumes**: Click this check box to enable full encryption on persistent disks of all BOSH deployed VMs except the <%= vars.ops_manager %> VM and BOSH Director VM.

      For more information about using EBS encryption, see [Configuring Amazon EBS Encryption for <%= vars.ops_manager %> on AWS](../install/cloudform-om-ebs-config.html).

      <p class="note important">
      <span class="note__title">Important</span> Enabling EBS encryption only encrypts Linux VMs. The Windows VMs deployed with <%= vars.windows_runtime_first %> or <%= vars.windows_runtime_abbr %> 2012 R2 are not encrypted.</p>

2. Click **Save**.

## <a id='pcfaws-om-dirconfig'></a> Step 3: Director Config page

<%= partial "../common/director-config" %>

## <a id='az'></a> Step 4: Create Availability Zones page

<%= vars.company_name %> recommends at least three availability zones (AZs) for a highly available installation of <%= vars.app_runtime_first %>. The procedures in <a href="prepare-env-manual.html">Preparing to Deploy <%= vars.ops_manager %> on AWS</a> use 3 AZs.

1. Click **Create Availability Zones**.

    ![alt-text="The Create Availability Zones page in Tanzu Operations Manager. See the following steps for information about each field."](../common/images/cloudform/create-az.png)

1. To add the three AZs you specified in the [Create a VPC](prepare-env-manual.html#pcfaws-vpc) section of _Preparing to Deploy <%= vars.ops_manager %> on AWS_:
    1. Click **Add**.
    2. For **Amazon Availability Zone**, enter the name of the AZ.
    3. Repeat until you have entered all three AZs, in the format `REGION-#a`, `REGION-#b`, and `REGION-#c`. For example, `us-west-2a`, `us-west-2b`, and `us-west-2c`.

2. Click **Save**.


## <a id='network'></a> Step 5: Create Networks page

1. Click **Create Networks**.

    ![alt-text="The Create Networks page in Tanzu Operations Manager. For more information, see the following steps for information about each field."](../common/images/cloudform/create-networks.png)

1. (Optional) Click **Enable ICMP checks** to enable ICMP on your networks. <%= vars.ops_manager %> uses ICMP checks to confirm that components within your network are reachable.

1. Perform the following steps to add the network configuration that you created for your VPC in the [Create a VPC](prepare-env-manual.html#pcfaws-vpc) in _Preparing to Deploy <%= vars.ops_manager %> on AWS_. Record your VPC CIDR if you set a CIDR other than the recommendation.

    1. Click **Add Network**.
    1. For **Name**, enter `management`.
    1. Create a subnet for each availability zone by clicking **Add Subnet**. See the following table for the information required to create all three subnets. When entering the **VPC Subnet ID** for each subnet, you must enter the corresponding Subnet ID associated with that subnet in the AWS VPC dashboard:

         <table class=“table”>
         <thead>
          <tr>
            <th rowspan="7">First<br>Subnet</th>
          </tr>
          </thead>
          <tr>
            <th>VPC subnet ID</th>
            <td>Subnet ID for <code>pcf-management-subnet-az0</code></td>
          </tr>
          <tr>
            <th>CIDR</th>
            <td><code>10.0.16.0/28</code></td>
          </tr>
          <tr>
            <th>Reserved IP ranges</th>
            <td><code>10.0.16.0-10.0.16.4</code></td>
          </tr>
          <tr>
            <th>DNS</th>
            <td><code>10.0.0.2</code><sup>*</sup></td>
          </tr>
          <tr>
            <th>Gateway</th>
            <td><code>10.0.16.1</code></td>
          </tr>
          <tr>
            <th>Availability zones</th>
            <td><code>REGION-#a</code>. Example: <code>us-west-2a</code></td>
          </tr>
          <tr>
            <th rowspan="7">Second<br>Subnet</th>
          </tr>
          <tr>
            <th>VPC subnet ID</th>
            <td>Subnet ID for <code>pcf-management-subnet-az1</code></td>
          </tr>
          <tr>
            <th>CIDR</th>
            <td><code>10.0.16.16/28</code></td>
          </tr>
          <tr>
            <th>Reserved IP ranges</th>
            <td><code>10.0.16.16-10.0.16.20</code></td>
          </tr>
          <tr>
            <th>DNS</th>
            <td><code>10.0.0.2</code><sup>*</sup></td>
          </tr>
          <tr>
            <th>Gateway</th>
            <td><code>10.0.16.17</code></td>
          </tr>
          <tr>
            <th>Availability zones</th>
            <td><code>REGION-#b</code>. Example: <code>us-west-2b</code></td>
          </tr>
          <tr>
            <th rowspan="7">Third<br>Subnet</th>
          </tr>
          <tr>
            <th>VPC subnet ID</th>
            <td>Subnet ID for <code>pcf-management-subnet-az2</code></td>
          </tr>
          <tr>
            <th>CIDR</th>
            <td><code>10.0.16.32/28</code></td>
          </tr>
          <tr>
            <th>Reserved IP ranges</th>
            <td><code>10.0.16.32-10.0.16.36</code></td>
          </tr>
          <tr>
            <th>DNS</th>
            <td><code>10.0.0.2</code><sup>*</sup></td>
          </tr>
          <tr>
            <th>Gateway</th>
            <td><code>10.0.16.33</code></td>
          </tr>
          <tr>
            <th>Availability zones</th>
            <td><code>REGION-#c</code>. Example: <code>us-west-2c</code></td>
          </tr>
        </table>

        <p class="note important">
        <span class="note__title">Important</span> If you set a VPC CIDR other than
        recommended, enter the second IP in your VPC CIDR. For example, for
        a <code>10.0.0.0/24</code> VPC CIDR, enter <code>10.0.0.2</code> in each subnet.</p

    1. Click **Add Network**.
    1. For **Name**, enter the name of your runtime. For example, `tas` or `pks`.
    1. Create a subnet for each availability zone by clicking **Add Subnet**. For more information, see the following table for the information required to create all three subnets:

          <table class=“table”>
          <thead>
          <tr>
            <th rowspan="7">First<br>Subnet</th>
          </tr>
          </thead>
          <tr>
            <th>VPC subnet ID</th>
            <td>Subnet ID for <code>pcf-tas-subnet-az0</code> or <code>pcf-pks-subnet-az0</code></td>
          </tr>
          <tr>
            <th>CIDR</th>
            <td><code>10.0.4.0/24</code></td>
          </tr>
          <tr>
            <th>Reserved IP ranges</th>
            <td><code>10.0.4.0-10.0.4.4</code></td>
          </tr>
          <tr>
            <th>DNS</th>
            <td><code>10.0.0.2</code><sup>*</sup></td>
          </tr>
          <tr>
            <th>Gateway</th>
            <td><code>10.0.4.1</code></td>
          </tr>
          <tr>
            <th>Availability zones</th>
            <td><code>REGION-#a</code>. Example: <code>us-west-2a</code></td>
          </tr>
           <tr>
            <th rowspan="7">Second<br>Subnet</th>
          </tr>
          <tr>
            <th>VPC subnet ID</th>
            <td>Subnet ID for <code>pcf-tas-subnet-az1</code> or <code>pcf-pks-subnet-az1</code></td>
          </tr>
          <tr>
            <th>CIDR</th>
            <td><code>10.0.5.0/24</code></td>
          </tr>
          <tr>
            <th>Reserved IP ranges</th>
            <td><code>10.0.5.0-10.0.5.4</code></td>
          </tr>
          <tr>
            <th>DNS</th>
            <td><code>10.0.0.2</code><sup>*</sup></td>
          </tr>
          <tr>
            <th>Gateway</th>
            <td><code>10.0.5.1</code></td>
          </tr>
          <tr>
            <th>Availability zones</th>
            <td><code>REGION-#b</code>. Example: <code>us-west-2b</code></td>
          </tr>
          <tr>
            <th rowspan="7">Third<br>Subnet</th>
          </tr>
          <tr>
            <th>VPC subnet ID</th>
            <td>Subnet ID for <code>pcf-tas-subnet-az2</code> or <code>pcf-pks-subnet-az2</code></td>
          </tr>
          <tr>
            <th>CIDR</th>
            <td><code>10.0.6.0/24</code></td>
          </tr>
          <tr>
            <th>Reserved IP ranges</th>
            <td><code>10.0.6.0-10.0.6.4</code></td>
          </tr>
          <tr>
            <th>DNS</th>
            <td><code>10.0.0.2</code><sup>*</sup></td>
          </tr>
          <tr>
            <th>Gateway</th>
            <td><code>10.0.6.1</code></td>
          </tr>
          <tr>
            <th>Availability zones</th>
            <td><code>REGION-#c</code>. Example: <code>us-west-2c</code></td>
          </tr>
        </table>

        If you set a VPC CIDR other than recommended, enter the second IP in your VPC CIDR. For example, for a <code>10.0.0.0/24</code> VPC CIDR, enter <code>10.0.0.2</code> in each subnet.

    1. Click **Add Network**.
    1. For **Name**, enter `services`.
    1. Create a subnet for each availability zone by clicking **Add Subnet**. See the following table for the information required to create all three subnets:

          <table class=“table”>
          <thead>
          <tr>
            <th rowspan="7">First<br>Subnet</th>
          </tr>
          </thead>
          <tr>
            <th>VPC subnet ID</th>
            <td>Subnet ID for <code>pcf-services-subnet-az0</code></td>
          </tr>
          <tr>
            <th>CIDR</th>
            <td><code>10.0.8.0/24</code></td>
          </tr>
          <tr>
            <th>Reserved IP ranges</th>
            <td><code>10.0.8.0-10.0.8.3</code></td>
          </tr>
          <tr>
            <th>DNS</th>
            <td><code>10.0.0.2</code><sup>*</sup></td>
          </tr>
          <tr>
            <th>Gateway</th>
            <td><code>10.0.8.1</code></td>
          </tr>
          <tr>
            <th>Availability zones</th>
            <td><code>REGION-#a</code>. Example: <code>us-west-2a</code></td>
          </tr>
           <tr>
            <th rowspan="7">Second<br>Subnet</th>
          </tr>
          <tr>
            <th>VPC subnet ID</th>
            <td>Subnet ID for <code>pcf-services-subnet-az1</code></td>
          </tr>
          <tr>
            <th>CIDR</th>
            <td><code>10.0.9.0/24</code></td>
          </tr>
          <tr>
            <th>Reserved IP ranges</th>
            <td><code>10.0.9.0-10.0.9.3</code></td>
          </tr>
          <tr>
            <th>DNS</th>
            <td><code>10.0.0.2</code><sup>*</sup></td>
          </tr>
          <tr>
            <th>Gateway</th>
            <td><code>10.0.9.1</code></td>
          </tr>
          <tr>
            <th>Availability zones</th>
            <td><code>REGION-#b</code>. Example: <code>us-west-2b</code></td>
          </tr>
          <tr>
            <th rowspan="7">Third<br>Subnet</th>
          </tr>
          <tr>
            <th>VPC subnet ID</th>
            <td>Subnet ID for <code>pcf-services-subnet-az2</code></td>
          </tr>
          <tr>
            <th>CIDR</th>
            <td><code>10.0.10.0/24</code></td>
          </tr>
          <tr>
            <th>Reserved IP ranges</th>
            <td><code>10.0.10.0-10.0.10.3</code></td>
          </tr>
          <tr>
            <th>DNS</th>
            <td><code>10.0.0.2</code><sup>*</sup></td>
          </tr>
          <tr>
            <th>Gateway</th>
            <td><code>10.0.10.1</code></td>
          </tr>
          <tr>
            <th>Availability zones</th>
            <td><code>REGION-#c</code>. Example: <code>us-west-2c</code></td>
          </tr>
        </table>

        If you set a VPC CIDR other than recommended, enter the second IP in your VPC CIDR. For example, for a <code>10.0.0.0/24</code> VPC CIDR, enter <code>10.0.0.2</code> in each subnet.

3. Click **Save**.

    If you are deploying <%= vars.k8s_runtime_first %> with a <%= vars.k8s_runtime_abbr %>  workload load balancer,
    you must tag each AWS subnet with your <%= vars.k8s_runtime_abbr %> Kubernetes cluster unique identifier before you create the load balancer.

    For more information about tagging subnets with a <%= vars.k8s_runtime_abbr %> cluster unique identifier,
    see <a href="https://docs.vmware.com/en/VMware-Tanzu-Kubernetes-Grid-Integrated-Edition/1.16/tkgi/GUID-deploy-workloads.html#aws">AWS Prerequisites</a>.

    <%= vars.expand_network_azs %>

## <a id='assign-azs'></a> Step 6: Assign AZs and Networks page

1. Click **Assign AZs and Networks**.

    ![alt-text="The Assign AZs and Networks page in Tanzu Operations Manager. For more information, see the following steps for information about each field."](../common/images/assign-az.png)

1. Click a **Singleton Availability Zone** from the drop-down menu. The BOSH Director is deployed into this AZ.

2. Click `management` under **Network**Use from the drop-down menu. The BOSH Director is deployed into this network.

3. Click **Save**.


## <a id='security'></a> Step 7: Security page

<%= partial "../common/security-pane" %>

## <a id='bosh-dns'></a> Step 8: BOSH DNS Config page

<%= partial "../common/bosh-dns-config" %>

## <a id='syslog'></a> Step 9: Syslog page

<%= partial "/pcf/ops-manager/syslog_bosh", :locals => { :syslog_context => 'BOSH Director' } %>

## <a id='pcfaws-om-rscestem'></a> Step 10: Resource Config page

1. Click **Resource Config**.

    ![alt-text="The Resource Config page in Tannzu Operations Manager. For more information, see the following steps for information about each field."](../common/images/cloudform/resource-config.png)

2. Adjust any values as necessary for your deployment. Under the **Instances**, **VM Type**, and **Persistent Disk Type** fields,
click **Automatic** from the drop-down menu to allocate the recommended resources for the job. If the **Persistent Disk Type** field reads **None**, the job does not require persistent disk space.

    For the BOSH Director job, click a VM type with at least 8&nbsp;GB memory.

    If you set a field to <strong>Automatic</strong> and the recommended resource allocation changes in a future version, <%= vars.ops_manager %> automatically uses the new recommended allocation.

    If you install <%= vars.windows_runtime_first %>, provision your <strong>Main Compilation Job</strong>
    with at least 100&nbsp;GB of disk space.

1. (Optional) To configure an Application Load Balancer (ALB) for your BOSH Director, click the icon next to the **BOSH Director** job name to see more fields.
Enter your AWS target group name in the **Load Balancers** field for the **BOSH Director** job. Prepend the name with `alb:`. For example, enter `alb:target-group-name`.

    To create an ALB and target group, follow the procedures in [Getting Started with Application Load Balancers](https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancer-getting-started.html) in the AWS documentation. Then go to **Target Groups** in the **EC2 Dashboard** menu to find your target group **Name**.

    To configure an ALB, you must have the following AWS IAM permissions.</p>
      <pre class="terminal">
      "elasticloadbalancing:DescribeLoadBalancers",
      "elasticloadbalancing:DeregisterInstancesFromLoadBalancer",
      "elasticloadbalancing:RegisterInstancesWithLoadBalancer",
      "elasticloadbalancing:DescribeTargetGroups",
      "elasticloadbalancing:RegisterTargets"
      </pre>

1. Click **Save**.

## <a id='pcfaws-om-complete'></a> Step 11: Complete the BOSH Director installation

1. Return to the <%= vars.ops_manager %> Installation Dashboard.

1. Click **Review Pending Changes**, then **Apply Changes**.

2. The BOSH Director installation begins. The **Changes Applied** window appears when the installation is complete.

    ![alt-text=""](../common/images/aws/vpc-step16.png)

## <a id='next'></a> Next steps

After you follow the procedures in this topic, you must configure a runtime for <%= vars.ops_manager %>.

You can install <%= vars.ops_manager %> on AWS with the <%= vars.app_runtime_abbr %> runtime.

To configure <%= vars.app_runtime_abbr %>, see [Configuring <%= vars.app_runtime_abbr %>](https://docs.vmware.com/en/VMware-Tanzu-Application-Service/<%= vars.dot_major_tas_version %>/tas-for-vms/prerequisites.html).
