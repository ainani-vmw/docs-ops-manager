---
title: Troubleshooting Tanzu Operations Manager on Azure
owner: Ops Manager, Release Integration
---

<html class="list-style-none"></html>

This topic describes how you can troubleshoot known issues when deploying or running <%= vars.ops_manager_first %> on Azure.

## <a id='install-issues'></a> Installation issues

This section describes how to troubleshoot known installation issues.

### <a id='cannot-copy-om'></a> Cannot copy the <%= vars.ops_manager %> image

#### Symptom

You cannot copy the <%= vars.ops_manager %> image into your storage account as part of [Step 4: Boot <%= vars.ops_manager %>](../azure/deploy-manual.html#boot) in _Deploying <%= vars.ops_manager %> on Azure_.

#### Explanation

You have an outdated version of the Azure CLI. You need Azure CLI v2.0.0 or later. To display your current Azure CLI version, run:

```
az --version
```

#### Solution

Install the Azure CLI v2.0 by following the instructions for your operating system in [Install the Azure CLI](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli) in the Microsoft Azure documentation.

### <a id='create-env-fails'></a> Deployment fails at "create-env"

#### Symptom

After you click **Review Pending Changes**, then **Apply Changes** to install <%= vars.ops_manager %> and <%= vars.app_runtime_first %>, the deployment
fails at `create-env` with an error message similar to the following:

```
Command 'deploy' failed:
  Deploying:
    Creating instance 'bosh/0':
      Waiting until instance is ready:
        Starting SSH tunnel:
          Parsing private key file '/tmp/bosh_ec2_private_key.pem':
            asn1: structure error: tags don't match (16 vs {class:3 tag:28 length:127
            isCompound:false}) {optional:false explicit:false application:false
            defaultValue:<nil> tag:<nil> stringType:0 timeType:0 set:false omitEmpty:false} pkcs1PrivateKey @2
			===== 2016-09-29 16:28:22 UTC Finished "<%= vars.bosh_deploy %>"
			/var/tempest/workspaces/default/deployments/bosh.yml";
			Duration: 328s; Exit Status: 1
Exited with 1.
```

#### Explanation

You provided a passphrase when you created your key pair in [Step 4: Boot <%= vars.ops_manager %>](../azure/deploy-manual.html#boot) in _Deploying <%= vars.ops_manager %> on Azure_.

#### Solution

Create a new key pair with no passphrase and do the installation again. For more information, see [Step 4: Boot <%= vars.ops_manager %>](../azure/deploy-manual.html#boot) in _Deploying <%= vars.ops_manager %> on Azure_.

### <a id='database-permissions'></a> Insufficient external database permissions

Upgrade issues can arise when the external database user that was used for the network policy database
is given insufficient permissions. To avoid this upgrade issue, ensure that the Network Policy Server database user
has the `ALL PRIVILEGES` permission.


## <a id='operation-issues'></a> Operation issues

This section describes how to troubleshoot known operation issues.

### <a id='timeouts'></a> Slow performance or timeouts

#### Symptom

Developers suffer from slow performance or timeouts when pushing or managing apps, and end users suffer from slow performance or timeouts when accessing apps.

#### Explanation

The Azure Load Balancer (ALB) disconnects active TCP connections lying idle for over four minutes.

#### Solution

To mitigate slow performance or timeouts, the default value of the **Back end request and idle timeout** field is set to `900` seconds. This default value is set high to mitigate performance issues but operators can tune this parameter to fit their infrastructure.

To edit the **Back end request and idle timeout** field:

1. Go to <%= vars.ops_manager %> Installation Dashboard.

1. Click the <%= vars.app_runtime_abbr %> tile.

1. Click **Networking**.

1. Enter your desired time, in seconds, in the **Back end request and idle timeout** text box.

1. Click **Save**.

### <a id='service-create-fail'></a> Service instance creation times out

#### Symptom

You are unable to provision a service instance of a Java or Go service. Running `cf create-service` fails with error `Failure provisioning service instance... Timed out after 8 minutes...` or similar.

#### Explanation

HTTP libraries for Java and Go, running with default settings, prune connections that have been idle for 240 seconds from their connection pool without sending a TCP reset message back to the client service broker. This removes the ability of the broker to provision new service instances.

#### Solution

In the **Networking** pane of the <%= vars.app_runtime_abbr %> tile, enter a value of `240` or less in the the **Front end idle timeout** field, so that <%= vars.ops_manager %> regenerates the front end connection before it times out.
