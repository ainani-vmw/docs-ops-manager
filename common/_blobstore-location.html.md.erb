1. Click **Blobstore Location** to configure the blobstore as either an internal server or an external endpoint.

    <p> After you deploy the BOSH Director, only <%= vars.ops_manager %> users in Advanced Mode can change the blobstore location. For more information, see <a href="https://docs.vmware.com/en/VMware-Tanzu-Operations-Manager/3.0/vmware-tanzu-ops-manager/install-platform-operators.html"><%= vars.ops_manager %> Fields That Lock On Deploy</a>.</p>

    * **Internal:** Use this option for an internal blobstore. No additional configuration is required.

    * **S3 Compatible Blobstore:** Use this option for an external S3-compatible endpoint.
      <% if current_page.data.iaas == "AWS" %>
      When you have created an S3 bucket, configure the following fields:
      <% else %>
      To create an S3 bucket, follow the procedures in [Sign up for Amazon S3](https://docs.aws.amazon.com/AmazonS3/latest/gsg/SigningUpforS3.html) and [Creating a Bucket](https://docs.aws.amazon.com/AmazonS3/latest/gsg/CreatingABucket.html) in the AWS documentation. When you have created an S3 bucket, configure the following fields:
      <% end %>

        1. **S3 Endpoint:**
            1. **If you are using a public S3 endpoint:**
                1. Locate the endpoint for your region. To find the endpoint, see the **Amazon Simple Storage Service (S3)** table in [Regions and Endpoints](http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region) in the AWS documentation.
                1. Construct a URL using your region's endpoint. For example, if you are using the `us-west-2` region, the URL you create would be <code>https://s3.us-west-2.amazonaws.com</code>. Enter this URL into the **S3 Endpoint** field.
            1. **If you are using a non-public S3-compatible endpoint:**
                1. Enter the URL for the non-public endpoint.
                1. Add the custom public CA certificate you used to sign the S3 endpoint to the **Trusted Certificates** field on the **Director Config** page.

        1. **Bucket Name:** Enter the name of the S3 bucket.
        <% if current_page.data.iaas == "AWS" %>
        1. **Credentials Source:**
        Input your credentials from the following sources.
            - **Static Credentials:** In **Access Key** and **Secret Key**, enter the keys you generated when creating your S3 bucket.
            - **IAM Instance Profile:** Use the IAM profile associated with the BOSH Director.<br>
              You must select the **Enable Signed URLs** check box to use IAM Profile credentials to access blobstores.
        <% else %>
        1. **Access Key** and **Secret Key:** Enter the keys you generated when creating your S3 bucket.
        <% end %>
        1. **Enable signed URLs:** Select this check box to configure BOSH VMs to generate short lived, pre-signed URLs for communication between the BOSH Agent and blobstore. If you enable this feature, BOSH Agents do not use credentials to communicate with the blobstore, and VM disks do not store blobstore credentials.
            <p> This feature is only available for BOSH VMs that use Xenial stemcell line 621 or later.</p>
        1. **URL Style:** Click either path-style or domain-style to specify the URL style for the S3-compatible blobstore. By default, the blobstore uses domain-style URLs.
            <p> AWS ends support for path-style URLs for all S3 buckets created after September 30, 2020. For more information, see <a href="https://docs.vmware.com/en/VMware-Tanzu-Operations-Manager/index.html">Support for Virtual-Hosted-Style URLs for AWS S3 Blobstores</a>.</p>
        1. Select **V2 Signature** or **V4 Signature**. If you select **V4 Signature**, enter your **Region**.
            <p> AWS recommends using Signature Version 4. For more information about AWS S3 Signatures, see <a href="http://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html">Authenticating Requests</a> in the AWS documentation.</p>
        1. **S3 Backup Strategy:** To configure whether and how to back up the BOSH Director's S3 blobstore, select one of the following options:
            * **No backups**
            * **Use a versioned bucket:** This option uses blobstore bucket versioning to save backups. It requires an S3 blobstore that supports versioning.
            * **Copy into an additional bucket:** This option saves blobstore backups to a separate bucket, which is useful with blobstores that do not support versioning. This option requires you to configure the **Backup Bucket Region** and **Backup Bucket Name** fields.

    * **GCS Blobstore:** Use this option for an external Google Cloud Storage (GCS) endpoint.

      ![alt-text=""](../common/images/gcp/blobstore-gcp.png)

      To create a GCS bucket, follow the procedures in [Creating Storage Buckets](https://cloud.google.com/storage/docs/creating-buckets) in the GCS documentation.
      <% if current_page.data.iaas != "GCP" %>
      To create a GCS bucket, you must have a GCS account.
      <% end %>
      When you have created a GCS bucket, configure the following fields:

          1. **Bucket Name:** Enter the name of your GCS bucket.
          2. **Storage Class:** Use this storage class for your GCS bucket. For more information, see [Storage Classes](https://cloud.google.com/storage/docs/storage-classes) in the GCP documentation.
          <% if current_page.data.iaas == "GCP" %>
          3. **Service Account Key:** Enter the contents of the JSON file that you downloaded in [Set up IAM Service Accounts](../gcp/prepare-env-manual.html#iam_account) in _Preparing to Deploy <%= vars.ops_manager %> on GCP_.
          <% else %>
          4. **Service Account Key:** Follow the steps in [Set up IAM Service Accounts](../gcp/prepare-env-manual.html#iam_account) in _Preparing to Deploy <%= vars.ops_manager %> on GCP_ to download a JSON file with a private key. Enter the contents
          of the JSON file into the text box.
          <% end %>
          5. **GCS Backup Strategy:** To configure whether and how to back up the BOSH Director's GCS blobstore, click one of the following options:
              * **No backups**
              * **Copy into an additional bucket:** This option saves blobstore backups to a bucket separate from the blobstore itself, and requires you to configure the **Backup Bucket Name** text box.
